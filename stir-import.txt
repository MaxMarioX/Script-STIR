#Skrypt odpowiedzialny za odbiór plików STIR z bramki BPS
option batch on
option confirm off
open sftp://********@***.***.***.***/ -hostkey="ssh-rsa 2048 OqfMOY3r********************************=" -privatekey="C:\Program Files (x86)\WinSCP\STIRKEYS\id_rsa.ppk" -passphrase=******
option transfer binary
#Przejście przez odpowiednie katalogi
cd 92830006
cd IMPORT
cd STIR
#Rozpoczęcie importu
#BLOKADY
cd BLOKADY_LOG
get BLEDY_BLOKADY_STIR_WER_20_92830006_*.XML S:\import\
get BLEDY_BLOKADY_STIR_WER_20_92830006_*.XML.SEM S:\import\
rm BLEDY_BLOKADY_STIR_WER_20_92830006_*.XML
rm BLEDY_BLOKADY_STIR_WER_20_92830006_*.XML.SEM
#DANE
cd ..
cd KARTOTEKI_LOG
get BLEDY_DANE_STIR_WER_20_92830006_*.XML S:\import\
get BLEDY_DANE_STIR_WER_20_92830006_*.XML.SEM S:\import\
rm BLEDY_DANE_STIR_WER_20_92830006_*.XML
rm BLEDY_DANE_STIR_WER_20_92830006_*.XML.SEM
#LOKATY
cd ..
cd LOKATY_LOG
get BLEDY_LOKATY_STIR_WER_20_92830006_*.XML S:\import\
get BLEDY_LOKATY_STIR_WER_20_92830006_*.XML.SEM S:\import\
rm BLEDY_LOKATY_STIR_WER_20_92830006_*.XML
rm BLEDY_LOKATY_STIR_WER_20_92830006_*.XML.SEM
#RACHUNKI WIRTUALNE
cd ..
cd RACH_WIRT_LOG
get RACH_WIRT_BLEDY_WER_20_92830006_*.TXT S:\import\
get RACH_WIRT_BLEDY_WER_20_92830006_*.TXT.SEM S:\import\
rm RACH_WIRT_BLEDY_WER_20_92830006_*.TXT
rm RACH_WIRT_BLEDY_WER_20_92830006_*.TXT.SEM
#RACHUNKI OSÓB
cd ..
cd REF_OF_LOG
get STIR_WT_RACHUNKI_OSOB_BLEDY_WER_20_92830006_*.TXT S:\import\
get STIR_WT_RACHUNKI_OSOB_BLEDY_WER_20_92830006_*.TXT.SEM S:\import\
rm STIR_WT_RACHUNKI_OSOB_BLEDY_WER_20_92830006_*.TXT
rm STIR_WT_RACHUNKI_OSOB_BLEDY_WER_20_92830006_*.TXT.SEM
#RACHUNKI OSÓB I TRANSAKCJE
cd ..
cd STIR_WT_LOG
get STIR_WT_RACHUNKI_BLEDY_WER_20_92830006_*.TXT S:\import\
get STIR_WT_RACHUNKI_BLEDY_WER_20_92830006_*.TXT.SEM S:\import\
get STIR_WT_TRANSAKCJE_BLEDY_WER_20_92830006_*.TXT S:\import\
get STIR_WT_TRANSAKCJE_BLEDY_WER_20_92830006_*.TXT.SEM S:\import\
rm STIR_WT_RACHUNKI_BLEDY_WER_20_92830006_*.TXT
rm STIR_WT_RACHUNKI_BLEDY_WER_20_92830006_*.TXT.SEM
rm STIR_WT_TRANSAKCJE_BLEDY_WER_20_92830006_*.TXT
rm STIR_WT_TRANSAKCJE_BLEDY_WER_20_92830006_*.TXT.SEM
# RISC
cd ..
cd RISC_SCORE
get OCENY_STIR_O_92830006_*.XML  "S:\ocena ryzyka odbiór plików\"
get OCENY_STIR_O_92830006_*.XML.SEM "S:\ocena ryzyka odbiór plików\"
get OCENY_STIR_W_92830006_*.XML  "S:\ocena ryzyka odbiór plików\"
get OCENY_STIR_W_92830006_*.XML.SEM "S:\ocena ryzyka odbiór plików\"
rm OCENY_STIR_O_92830006_*.XML
rm OCENY_STIR_O_92830006_*.XML.SEM
rm OCENY_STIR_W_92830006_*.XML
rm OCENY_STIR_W_92830006_*.XML.SEM
cd /
close
exit